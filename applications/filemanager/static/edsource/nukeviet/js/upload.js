function nv_randomNum(a){for(var b="",d=0;d<a;d++)b+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".charAt(Math.floor(62*Math.random()));return b}function resize_byWidth(a,b,d){return Math.round(d/a*b)}function resize_byHeight(a,b,d){return Math.round(d/b*a)}function calSize(a,b,d,e){a>d&&(b=resize_byWidth(a,b,d),a=d);b>e&&(a=resize_byHeight(a,b,e),b=e);return[a,b]}function calSizeMax(a,b,d,e){var g=d,d=resize_byWidth(a,b,d);d<=e||(d=e,g=resize_byHeight(a,b,e));return[g,d]}
function calSizeMin(a,b,d,e){var g=d,d=resize_byWidth(a,b,d);d>=e||(d=e,g=resize_byHeight(a,b,e));return[g,d]}function is_numeric(a){return("number"===typeof a||"string"===typeof a)&&""!==a&&!isNaN(a)}
function checkNewSize(){var a=$("input[name=newWidth]").val(),b=$("input[name=newHeight]").val(),d=[],e=$("input[name=origWidth]").val(),g=$("input[name=origHeight]").val(),j=calSizeMax(e,g,nv_max_width,nv_max_height),e=calSizeMin(e,g,nv_min_width,nv_min_height);""==a||!is_numeric(a)?d=[LANG.errorEmptyX,"newWidth"]:a>j[0]?d=[LANG.errorMaxX,"newWidth"]:a<e[0]?d=[LANG.errorMinX,"newWidth"]:""==b||!is_numeric(b)?d=[LANG.errorEmptyY,"newHeight"]:b>j[1]?d=[LANG.errorMaxY,"newHeight"]:b<e[1]&&(d=[LANG.errorMinY,
"newHeight"]);$("div[title=createInfo]").find("div").remove();if("undefined"!=typeof d[0])return $("div[title=createInfo]").prepend('<div class="red">'+d[0]+"</div>"),$("input[name='"+d[1]+"']").select(),!1;a=calSize(a,b,360,230);$("img[name=myFile2]").width(a[0]).height(a[1]);return!0}function pathList(a,b){var d=[];$("#foldertree").find("span").each(function(){if($(this).attr("title")==b||""!=$(this).attr("title")&&$(this).is("."+a))d[d.length]=$(this).attr("title")});return d}
function insertvaluetofield(){var a=$("input[name=CKEditorFuncNum]").val(),b=$("input[name=area]").val(),d=nv_base_siteurl+$("span#foldervalue").attr("title")+"/"+$("input[name=selFile]").val();0<a&&(window.opener.CKEDITOR.tools.callFunction(a,d,""),window.close());""!=b&&($("#"+b,opener.document).val(d),window.close())}
function nv_selFile(a){var b=$("input[name=CKEditorFuncNum]").val(),d=$("input[name=area]").val();0<b&&(window.opener.CKEDITOR.tools.callFunction(b,a,""),window.close());""!=d&&($("#"+d,opener.document).val(a),window.close())}function download(){var a=$("span#foldervalue").attr("title"),b=$("input[name=selFile]").val();$("iframe#Fdownload").attr("src",nv_module_url+"dlimg&path="+a+"&img="+b)}
function preview(){$("div.dynamic").text("");$("input.dynamic").val("");var a=$("input[name=selFile]").val(),b=$("span#foldervalue").attr("title"),d=$("img[title='"+a+"']").attr("name"),e=LANG.upload_size+": ",d=d.split("|");if("image"==d[3]||"swf"==d[2]){var g=calSize(d[0],d[1],360,230),e=e+(d[0]+" x "+d[1]+" pixels ("+d[4]+")<br />");"image"==d[3]?$("div#fileView").html('<img style="border:2px solid #F0F0F0;" width="'+g[0]+'" height="'+g[1]+'" src="'+nv_base_siteurl+b+"/"+a+'" />'):$("#fileView").flash({src:nv_base_siteurl+
b+"/"+a,width:g[0],height:g[1]},{version:8})}else e+=d[4]+"<br />",b=$("div[title='"+a+"'] div").html(),$("div#fileView").html(b);e+=LANG.pubdate+": "+d[6];$("#fileInfoDetail").html(e);$("#fileInfoName").html(a);$("div#imgpreview").dialog({autoOpen:!1,width:388,modal:!0,position:"center"}).dialog("open").dblclick(function(){$("div#imgpreview").dialog("close")})}
function addlogo(){var a=$("input[name=selFile]").val(),b=$("span#foldervalue").attr("title");$("img[title='"+a+"']").attr("name");LeftPosition=screen.width?(screen.width-850)/2:0;TopPosition=screen.height?(screen.height-420)/2:0;settings="height=420,width=850,top="+TopPosition+",left="+LeftPosition+",scrollbars,resizable";window.open(nv_module_url+"addlogo&path="+b+"&file="+a,"addlogo",settings)}
function create(){$("div.dynamic").text("");$("input.dynamic").val("");var a=$("input[name=selFile]").val(),b=$("span#foldervalue").attr("title"),d=$("img[title='"+a+"']").attr("name"),d=d.split("|");if("image"==d[3]){$("input[name=origWidth]").val(d[0]);$("input[name=origHeight]").val(d[1]);var e=calSizeMax(d[0],d[1],nv_max_width,nv_max_height),g=calSizeMin(d[0],d[1],nv_min_width,nv_min_height);$("div[title=createInfo]").html("Max: "+e[0]+" x "+e[1]+", Min: "+g[0]+" x "+g[1]+" (pixels)");e=calSize(d[0],
d[1],360,230);$("img[name=myFile2]").width(e[0]).height(e[1]).attr("src",nv_base_siteurl+b+"/"+a);$("#fileInfoDetail2").html(LANG.origSize+": "+d[0]+" x "+d[1]+" pixels");$("#fileInfoName2").html(a);$("div#imgcreate").dialog({autoOpen:!1,width:650,modal:!0,position:"center"}).dialog("open")}}
function move(){$("div.dynamic").text("");$("input.dynamic").attr("checked",!1);var a=$("span#foldervalue").attr("title"),b=pathList("create_file",a),d,e,g=$("input[name=selFile]").val();for(e in b)d=a==b[e]?' selected="selected"':"",$("select[name=newPath]").append('<option value="'+b[e]+'"'+d+">"+b[e]+"</option>");$("div[title=pathFileName]").text(a+"/"+g);$("div#filemove").dialog({autoOpen:!1,width:300,modal:!0,position:"center"}).dialog("open")}
function filerename(){$("div.dynamic, span.dynamic").text("");$("input.dynamic").val("");var a=$("input[name=selFile]").val();$("div#filerenameOrigName").text(a);a=a.replace(/^(.+)\.([a-zA-Z0-9]+)$/,"$2");$("span[title=Ext]").text("."+a);$("div#filerename").dialog({autoOpen:!1,width:300,modal:!0,position:"center"}).dialog("open")}
function filedelete(){var a=$("input[name=selFile]").val(),b=$("span#foldervalue").attr("title"),d=$("select[name=imgtype]").val(),e=1==$("select[name=author]").val()?"&author":"";confirm(LANG.upload_delimg_confirm+" "+a+" ?")&&$.ajax({type:"POST",url:nv_module_url+"delimg",data:"path="+b+"&file="+a,success:function(){$("#imglist").load(nv_module_url+"imglist&path="+b+"&type="+d+e+"&num="+ +nv_randomNum(10))}})}
function fileMouseup(a){$(".imgsel").removeClass("imgsel");$(a).addClass("imgsel");a=$(a).attr("title");$("input[name=selFile]").val(a);var a=a.slice(-3),b=$("input[name=CKEditorFuncNum]").val(),d=$("input[name=area]").val(),e="<ul>";if(0<b||""!=d)e+='<li id="select"><img style="margin-right:5px" src="'+ICON.select+'"/>'+LANG.select+"</li>";e+='<li id="download"><img style="margin-right:5px" src="'+ICON.download+'"/>'+LANG.download+"</li>";e+='<li id="filepreview"><img style="margin-right:5px" src="'+
ICON.preview+'"/>'+LANG.preview+"</li>";-1!==$.inArray(a,array_images)&&"1"==$("span#create_file").attr("title")&&(e+='<li id="fileaddlogo"><img style="margin-right:5px" src="'+ICON.preview+'"/>'+LANG.addlogo+"</li>",e+='<li id="create"><img style="margin-right:5px" src="'+ICON.create+'"/>'+LANG.upload_createimage+"</li>");"1"==$("span#move_file").attr("title")&&(e+='<li id="move"><img style="margin-right:5px" src="'+ICON.move+'"/>'+LANG.move+"</li>");"1"==$("span#rename_file").attr("title")&&(e+=
'<li id="rename"><img style="margin-right:5px" src="'+ICON.rename+'"/>'+LANG.rename+"</li>");"1"==$("span#delete_file").attr("title")&&(e+='<li id="filedelete"><img style="margin-right:5px" src="'+ICON.filedelete+'"/>'+LANG.upload_delfile+"</li>");$("div#contextMenu").html(e+"</ul>")}
function is_allowed_upload(){$("input[name=fileupload]").parent().css("display","block");"1"==$("span#upload_file").attr("title")?$("input[name=fileupload]").parent().parent().css("display","block").next().css("display","none"):$("input[name=fileupload]").parent().parent().css("display","none").next().css("display","block")}
function folderClick(a){var b=$(a).attr("title");if(b!=$("span#foldervalue").attr("title")){$("span#foldervalue").attr("title",b);$("span#view_dir").attr("title",$(a).is(".view_dir")?"1":"0");$("span#create_dir").attr("title",$(a).is(".create_dir")?"1":"0");$("span#rename_dir").attr("title",$(a).is(".rename_dir")?"1":"0");$("span#delete_dir").attr("title",$(a).is(".delete_dir")?"1":"0");$("span#upload_file").attr("title",$(a).is(".upload_file")?"1":"0");$("span#create_file").attr("title",$(a).is(".create_file")?
"1":"0");$("span#rename_file").attr("title",$(a).is(".rename_file")?"1":"0");$("span#delete_file").attr("title",$(a).is(".delete_file")?"1":"0");$("span#move_file").attr("title",$(a).is(".move_file")?"1":"0");$("span.folder").css("color","");$(a).css("color","red");if($(a).is(".view_dir")){var a=$("select[name=imgtype]").val(),d=$("input[name=selFile]").val(),e=1==$("select[name=author]").val()?"&author":"";$("div#imglist").html('<p style="padding:20px; text-align:center"><img src="'+nv_base_siteurl+
'images/load_bar.gif"/> please wait...</p>').load(nv_module_url+"imglist&path="+b+"&imgfile="+d+"&type="+a+e+"&random="+nv_randomNum(10))}else $("div#imglist").text("");is_allowed_upload()}}
function menuMouseup(a){$(a).attr("title");$("span").attr("name","");$(a).attr("name","current");var b="";$(a).is(".create_dir")&&(b+='<li id="createfolder"><img style="margin-right:5px" src="'+ICON.create+'"/>'+LANG.createfolder+"</li>");$(a).is(".rename_dir")&&(b+='<li id="renamefolder"><img style="margin-right:5px" src="'+ICON.rename+'"/>'+LANG.renamefolder+"</li>");$(a).is(".delete_dir")&&(b+='<li id="deletefolder"><img style="margin-right:5px" src="'+ICON.filedelete+'"/>'+LANG.deletefolder+"</li>");
""!=b&&(b="<ul>"+b+"</ul>");$("div#contextMenu").html(b)}function renamefolder(){var a=$("span[name=current]").attr("title").split("/"),a=a[a.length-1];$("input[name=foldername]").val(a);$("div#renamefolder").dialog("open")}function createfolder(){$("input[name=createfoldername]").val("");$("div#createfolder").dialog("open")}
function deletefolder(){if(confirm(LANG.delete_folder)){var a=$("span[name=current]").attr("title");$.ajax({type:"POST",url:nv_module_url+"delfolder&random="+nv_randomNum(10),data:"path="+a,success:function(b){b=b.split("_");if("ERROR"==b[0])alert(b[1]);else{b=a.split("/");a="";for(i=0;i<b.length-1;i++)""!=a&&(a+="/"),a+=b[i];var b=$("select[name=imgtype]").val(),d=1==$("select[name=author]").val()?"&author":"",e=$("span#path").attr("title"),g=$("input[name=selFile]").val();$("#imgfolder").load(nv_module_url+
"folderlist&path="+e+"&currentpath="+a+"&random="+nv_randomNum(10));$("div#imglist").load(nv_module_url+"imglist&path="+a+"&imgfile="+g+"&type="+b+d+"&random="+nv_randomNum(10))}}})}}$("select[name=imgtype]").change(function(){var a=$("span#foldervalue").attr("title"),b=$(this).val(),d=$("input[name=selFile]").val(),e=1==$("select[name=author]").val()?"&author":"";$("#imglist").load(nv_module_url+"imglist&path="+a+"&type="+b+"&imgfile="+d+e+"&random="+nv_randomNum(10))});
$("select[name=author]").change(function(){var a=$("span#foldervalue").attr("title"),b=$("input[name=selFile]").val(),d=$("select[name=imgtype]").val(),e=1==$(this).val()?"&author":"";$("#imglist").load(nv_module_url+"imglist&path="+a+"&type="+d+"&imgfile="+b+e+"&random="+nv_randomNum(10))});
$(".refresh a").click(function(){var a=$("span#foldervalue").attr("title"),b=$("select[name=imgtype]").val(),d=$("input[name=selFile]").val(),e=1==$("select[name=author]").val()?"&author":"",g=$("span#path").attr("title");$("#imgfolder").load(nv_module_url+"folderlist&path="+g+"&currentpath="+a+"&dirListRefresh&random="+nv_randomNum(10));$("#imglist").load(nv_module_url+"imglist&path="+a+"&type="+b+"&imgfile="+d+e+"&refresh&random="+nv_randomNum(10));return!1});
$("input[name=fileupload]").change(function(){var a=$(this).val();f=a.replace(/.*\\(.*)/,"$1").replace(/.*\/(.*)/,"$1");$(this).parent().prev().html(f);a=a+" "+$("span#foldervalue").attr("title");$("input[name=currentFileUpload]").val()!=a&&$(this).parent().next().next().css("display","none").next().css("display","none")});$("input[name=imgurl]").change(function(){$(this).parent().next().next().css("display","none").next().css("display","none")});
$("#confirm").click(function(){var a=$("input[name=fileupload]").val(),b=$("span#foldervalue").attr("title"),d=$("input[name=currentFileUpload]").val(),e=a+" "+b,g=$("select[name=imgtype]").val(),j=1==$("select[name=author]").val()?"&author":"";if(""!=a&&d!=e)$("input[name=fileupload]").parent().css("display","none").next().css("display","block").next().css("display","none"),$("input[name=fileupload]").upload(nv_module_url+"upload&random="+nv_randomNum(10),"path="+b,function(a){$("input[name=currentFileUpload]").val(e);
var d=a.split("_");if("ERROR"==d[0])$("div#errorInfo").html(d[1]).dialog("open"),$("input[name=fileupload]").parent().css("display","block").next().css("display","none").next().css("display","none").next().css("display","block");else{$("input[name=fileupload]").parent().css("display","block").next().css("display","none").next().css("display","block");$("input[name=selFile]").val(a);var d=$("input[name=CKEditorFuncNum]").val(),h=$("input[name=area]").val();0<d||""!=h?$("#cfile").html('<a href="javascript:void(0);" onclick="nv_selFile(\''+
nv_base_siteurl+b+"/"+a+"')\">"+a+"</a>"):$("#cfile").html(a);$("#imglist").load(nv_module_url+"imglist&path="+b+"&type="+g+j+"&imgfile="+a)}},"html");else{var a=$("input[name=imgurl]").val(),d=$("input[name=currentFileUrl]").val(),h=a+" "+b;/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)&&
d!=h&&($("input[name=imgurl]").parent().css("display","none").next().css("display","block").next().css("display","none"),$.ajax({type:"POST",url:nv_module_url+"upload&random="+nv_randomNum(10),data:"path="+b+"&fileurl="+a,success:function(a){$("input[name=currentFileUrl]").val(h);var d=a.split("_");"ERROR"==d[0]?($("div#errorInfo").html(d[1]).dialog("open"),$("input[name=imgurl]").parent().css("display","block").next().css("display","none").next().css("display","none").next().css("display","block")):
($("input[name=imgurl]").parent().css("display","block").next().css("display","none").next().css("display","block").next().css("display","none"),$("input[name=selFile]").val(a),$("#imglist").load(nv_module_url+"imglist&path="+b+"&type="+g+"&imgfile="+a+j+"&num="+ +nv_randomNum(10)))}}))}});$("div#errorInfo").dialog({autoOpen:!1,width:300,height:180,modal:!0,position:"center",show:"slide"});
$("div#renamefolder").dialog({autoOpen:!1,width:250,height:160,modal:!0,position:"center",buttons:{Ok:function(){var a=$("span[name=current]").attr("title"),b=$("input[name=foldername]").val(),d=$("span#foldervalue").attr("title"),e=a.split("/"),e=e[e.length-1];if(""==b||b==e||!nv_namecheck.test(b))return alert(LANG.rename_nonamefolder),$("input[name=foldername]").focus(),!1;var e=$("span[name=current]").attr("class").split(" "),e=e[e.length-1],g=!0;$("span."+e).each(function(){var a=$(this).attr("title").split("/"),
a=a[a.length-1];b==a&&(g=!1)});if(!g)return alert(LANG.folder_exists),$("input[name=foldername]").focus(),!1;$.ajax({type:"POST",url:nv_module_url+"renamefolder&random="+nv_randomNum(10),data:"path="+a+"&newname="+b,success:function(b){var e=b.split("_");if("ERROR"==e[0])alert(e[1]);else{var e=b.split("/"),e=e[e.length-1],g;$("span[name=current]").parent().find("span").each(function(){g=$(this).attr("title");g=g.replace(a,b);$(this).attr("title")==d&&$("span#foldervalue").attr("title",g);$(this).attr("title",
g)});$("span[name=current]").html("&nbsp;"+e).attr("title",b)}}});$(this).dialog("close")}}});
$("div#createfolder").dialog({autoOpen:!1,width:250,height:160,modal:!0,position:"center",buttons:{Ok:function(){var a=$("input[name=createfoldername]").val(),b=$("span[name=current]").attr("title");if(""==a||!nv_namecheck.test(a))return alert(LANG.name_folder_error),$("input[name=createfoldername]").focus(),!1;$.ajax({type:"POST",url:nv_module_url+"createfolder&random="+nv_randomNum(10),data:"path="+b+"&newname="+a,success:function(a){var b=a.split("_");if("ERROR"==b[0])alert(b[1]);else{var b=$("select[name=imgtype]").val(),
g=1==$("select[name=author]").val()?"&author":"",j=$("span#path").attr("title");$("#imgfolder").load(nv_module_url+"folderlist&path="+j+"&currentpath="+a+"&random="+nv_randomNum(10));$("div#imglist").load(nv_module_url+"imglist&path="+a+"&type="+b+g+"&random="+nv_randomNum(10))}}});$(this).dialog("close")}}});
$("input[name=newWidth], input[name=newHeight]").keyup(function(){var a=$(this).attr("name"),b=$("input[name='"+a+"']").val(),d=$("input[name=origWidth]").val(),e=$("input[name=origHeight]").val(),g=calSizeMax(d,e,nv_max_width,nv_max_height),g="newWidth"==a?g[0]:g[1];!is_numeric(b)||b>g||0>b?($("input[name=newWidth]").val(""),$("input[name=newHeight]").val("")):"newWidth"==a?$("input[name=newHeight]").val(resize_byWidth(d,e,b)):$("input[name=newWidth]").val(resize_byHeight(d,e,b))});$("input[name=prView]").click(function(){checkNewSize()});
$("input[name=newSizeOK]").click(function(){var a=$("input[name=newWidth]").val(),b=$("input[name=newHeight]").val(),d=$("input[name=origWidth]").val(),e=$("input[name=origHeight]").val();if(a==d&&b==e)$("div#imgcreate").dialog("close");else if(!1!==checkNewSize()){$(this).attr("disabled","disabled");var d=$("input[name=selFile]").val(),g=$("span#foldervalue").attr("title");$.ajax({type:"POST",url:nv_module_url+"createimg",data:"path="+g+"&img="+d+"&width="+a+"&height="+b+"&num="+nv_randomNum(10),
success:function(a){var b=a.split("_");if("ERROR"==b[0])alert(b[1]),$("input[name=newSizeOK]").removeAttr("disabled");else{var b=$("select[name=imgtype]").val(),d=1==$("select[name=author]").val()?"&author":"";$("input[name=selFile]").val(a);$("input[name=newSizeOK]").removeAttr("disabled");$("div#imgcreate").dialog("close");$("#imglist").load(nv_module_url+"imglist&path="+g+"&type="+b+"&imgfile="+a+d+"&num="+ +nv_randomNum(10))}}})}});
$("input[name=newPathOK]").click(function(){var a=$("span#foldervalue").attr("title"),b=$("select[name=newPath]").val(),d=$("input[name=selFile]").val(),e=$("input[name=mirrorFile]:checked").length;a==b?$("div#filemove").dialog("close"):($(this).attr("disabled","disabled"),$.ajax({type:"POST",url:nv_module_url+"moveimg&num="+nv_randomNum(10),data:"path="+a+"&newpath="+b+"&file="+d+"&mirror="+e,success:function(d){var e=d.split("_");if("ERROR"==e[0])alert(e[1]),$("input[name=newPathOK]").removeAttr("disabled");
else{var e=$("select[name=imgtype]").val(),h=$("input[name=goNewPath]:checked").length,k=1==$("select[name=author]").val()?"&author":"";$("input[name=selFile]").val(d);$("input[name=newPathOK]").removeAttr("disabled");$("div#filemove").dialog("close");1==h?(h=$("span#path").attr("title"),$("#imgfolder").load(nv_module_url+"folderlist&path="+h+"&currentpath="+b+"&random="+nv_randomNum(10)),$("#imglist").load(nv_module_url+"imglist&path="+b+"&type="+e+"&imgfile="+d+k+"&num="+ +nv_randomNum(10))):$("#imglist").load(nv_module_url+
"imglist&path="+a+"&type="+e+"&imgfile="+d+k+"&num="+ +nv_randomNum(10))}}}))});
$("input[name=filerenameOK]").click(function(){var a=$("span#foldervalue").attr("title"),b=$("input[name=selFile]").val(),d=$("input[name=filerenameNewName]").val(),e=b.match(/^(.+)\.([a-zA-Z0-9]+)$/),d=$.trim(d);$("input[name=filerenameNewName]").val(d);""==d?(alert(LANG.rename_noname),$("input[name=filerenameNewName]").focus()):e[1]==d?$("div#filerename").dialog("close"):($(this).attr("disabled","disabled"),$.ajax({type:"POST",url:nv_module_url+"renameimg&num="+nv_randomNum(10),data:"path="+a+"&file="+
b+"&newname="+d,success:function(b){var d=b.split("_");if("ERROR"==d[0])alert(d[1]),$("input[name=filerenameOK]").removeAttr("disabled");else{var d=$("select[name=imgtype]").val(),e=1==$("select[name=author]").val()?"&author":"";$("input[name=filerenameOK]").removeAttr("disabled");$("div#filerename").dialog("close");$("#imglist").load(nv_module_url+"imglist&path="+a+"&type="+d+"&imgfile="+b+e+"&num="+nv_randomNum(10))}}}))});
$("img[name=myFile2]").dblclick(function(){$("div[title=createInfo]").find("div").remove();var a=$("input[name=origWidth]").val(),b=$("input[name=origHeight]").val();c=calSize(a,b,360,230);$(this).width(c[0]).height(c[1]);$("input[name=newHeight]").val(b);$("input[name=newWidth]").val(a).select()});
