(function(b){function l(c){return b.map(m(c),function(b){return'<input type="hidden" name="'+b.name+'" value="'+b.value+'"/>'}).join("")}function m(c){function d(b,c){a.push({name:b,value:c})}if(b.isArray(c))return c;var a=[];"object"===typeof c?b.each(c,function(a){b.isArray(this)?b.each(this,function(){d(a,this)}):d(a,b.isFunction(this)?this():this)}):"string"===typeof c&&b.each(c.split("&"),function(){var a=b.map(this.split("="),function(a){return decodeURIComponent(a.replace(/\+/g," "))});d(a[0],
a[1])});return a}function n(c,d){var a;a=b(c).contents().get(0);if(b.isXMLDoc(a)||a.XMLDocument)return a.XMLDocument||a;a=b(a).find("body").html();switch(d){case "xml":if(window.DOMParser)a=(new DOMParser).parseFromString(a,"application/xml");else{var e=new ActiveXObject("Microsoft.XMLDOM");e.async=!1;e.loadXML(a);a=e}break;case "json":a=window.eval("("+a+")")}return a}var o=0;b.fn.upload=function(c,d,a,e){var i=this,f,j,g;g="jquery_upload"+ ++o;var k=b('<iframe name="'+g+'" style="position:absolute;top:-9999px" />').appendTo("body"),
h='<form target="'+g+'" method="post" enctype="multipart/form-data" />';b.isFunction(d)&&(e=a,a=d,d={});j=b("input:checkbox",this);g=b("input:checked",this);h=i.wrapAll(h).parent("form").attr("action",c);j.removeAttr("checked");g.attr("checked",!0);f=(f=l(d))?b(f).appendTo(h):null;h.submit(function(){k.load(function(){var c=n(this,e),d=b("input:checked",i);h.after(i).remove();j.removeAttr("checked");d.attr("checked",true);f&&f.remove();setTimeout(function(){k.remove();e==="script"&&b.globalEval(c);
a&&a.call(i,c)},0)})}).submit();return this}})(jQuery);