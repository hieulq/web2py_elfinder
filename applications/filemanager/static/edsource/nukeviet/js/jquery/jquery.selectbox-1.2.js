jQuery.fn.extend({selectbox:function(h){return this.each(function(){new jQuery.SelectBox(this,h)})}});if(!window.console)var console={log:function(){}};
jQuery.SelectBox=function(h,p){function j(){i=0;d.hide()}function m(c){var b=jQuery("li",d);if(!b||0==b.length)return!1;for(firstchoice=0;$(b[firstchoice]).hasClass(a.groupClass);)firstchoice++;e+=c;$(b[e]).hasClass(a.groupClass)&&(e+=c);e<firstchoice?a.loopnoStep?e=b.size()-1:e=b.size():a.loopnoStep&&e>b.size()-1?e=firstchoice:e>b.size()&&(e=firstchoice);var f=jQuery(b[e]).get(0),c=d.get(0);f.offsetTop+f.offsetHeight>c.scrollTop+c.clientHeight?c.scrollTop=f.offsetTop+f.offsetHeight-c.clientHeight:
f.offsetTop<c.scrollTop&&(c.scrollTop=f.offsetTop);b.removeClass(a.hoverClass);jQuery(b[e]).addClass(a.hoverClass)}function n(){var c=jQuery("li."+a.currentClass,d).get(0),b=(""+c.id).split("_"),b=b[b.length-1];a.onChangeCallback?(f.get(0).selectedIndex=$("li",d).index(c),a.onChangeParams={selectedVal:f.val()},a.onChangeCallback(a.onChangeParams)):(f.val(b),f.change());"span"==a.inputType?g.html($(c).html()):g.val($(c).html());return!0}function q(c){var b=[],e=document.createElement("ul"),b=f.children("option");
if(0==b.length){var h=[],h=f.children("optgroup");for(x=0;x<h.length;x++){var b=$("#"+h[x].id).children("option"),k=document.createElement("li");k.setAttribute("id",c+"_"+$(this).val());k.innerHTML=$("#"+h[x].id).attr("label");k.className=a.groupClass;e.appendChild(k);b.each(function(){var b=document.createElement("li");b.setAttribute("id",c+"_"+$(this).val());b.innerHTML=$(this).html();$(this).is(":selected")&&(g.html($(this).html()),$(b).addClass(a.currentClass));e.appendChild(b);$(b).mouseover(function(b){i=
1;a.debug&&console.log("over on : "+this.id);jQuery(b.target,d).addClass(a.hoverClass)}).mouseout(function(b){i=-1;a.debug&&console.log("out on : "+this.id);jQuery(b.target,d).removeClass(a.hoverClass)}).click(function(){$("li."+a.hoverClass,d).get(0);a.debug&&console.log("click on :"+this.id);$("li."+a.currentClass,d).removeClass(a.currentClass);$(this).addClass(a.currentClass);n();f.get(0).blur();j()})})}}else b.each(function(){var b=document.createElement("li");b.setAttribute("id",c+"_"+$(this).val());
b.innerHTML=$(this).html();$(this).is(":selected")&&(g.val($(this).html()),$(b).addClass(a.currentClass));e.appendChild(b);$(b).mouseover(function(b){i=1;a.debug&&console.log("over on : "+this.id);jQuery(b.target,d).addClass(a.hoverClass)}).mouseout(function(b){i=-1;a.debug&&console.log("out on : "+this.id);jQuery(b.target,d).removeClass(a.hoverClass)}).click(function(){$("li."+a.hoverClass,d).get(0);a.debug&&console.log("click on :"+this.id);$("li."+a.currentClass,d).removeClass(a.currentClass);
$(this).addClass(a.currentClass);n();f.get(0).blur();j()})});return e}var a=p||{};a.inputType=a.inputType||"input";a.inputClass=a.inputClass||"selectbox";a.containerClass=a.containerClass||"selectbox-wrapper";a.hoverClass=a.hoverClass||"current";a.currentClass=a.currentClass||"selected";a.groupClass=a.groupClass||"groupname";a.maxHeight=a.maxHeight||200;a.loopnoStep=a.loopnoStep||!1;a.onChangeCallback=a.onChangeCallback||!1;a.onChangeParams=a.onChangeParams||!1;a.debug=a.debug||!1;var l=h.id,e=0,
o=!1,i=0,f=jQuery(h),d=function(a){var b=document.createElement("div");d=jQuery(b);d.attr("id",l+"_container");d.addClass(a.containerClass);d.css("display","none");return d}(a),g=function(c){if("span"==a.inputType){var b=document.createElement("span"),b=jQuery(b);b.attr("id",l+"_input");b.addClass(c.inputClass);b.attr("tabIndex",f.attr("tabindex"))}else b=document.createElement("input"),b=jQuery(b),b.attr("id",l+"_input"),b.attr("type","text"),b.addClass(c.inputClass),b.attr("autocomplete","off"),
b.attr("readonly","readonly"),b.attr("tabIndex",f.attr("tabindex")),b.css("width",f.css("width"));return b}(a);f.hide().before(g).before(d);(function(){d.append(q(g.attr("id"))).hide();var c=g.css("width");d.height()>a.maxHeight?(d.width(parseInt(c)+parseInt(g.css("paddingRight"))+parseInt(g.css("paddingLeft"))),d.height(a.maxHeight)):d.width(c)})();g.click(function(){o||d.toggle()}).focus(function(){d.not(":visible")&&(o=!0,d.show())}).keydown(function(c){switch(c.keyCode){case 38:c.preventDefault();
m(-1);break;case 40:c.preventDefault();m(1);break;case 13:c.preventDefault();$("li."+a.hoverClass).trigger("click");break;case 27:j()}}).blur(function(){d.is(":visible")&&0<i?a.debug&&console.log("container visible and has focus"):jQuery.browser.msie&&8>jQuery.browser.version.substr(0,1)||jQuery.browser.safari?-1==document.activeElement.getAttribute("id").indexOf("_container")?j():g.focus():j()})};