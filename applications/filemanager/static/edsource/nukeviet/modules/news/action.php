<?php

/**
 * @Project NUKEVIET 3.4
 * @Author VINADES.,JSC (contact@vinades.vn)
 * @Copyright (C) 2010 - 2012 VINADES.,JSC. All rights reserved
 * @Createdate Sun, 08 Apr 2012 00:00:00 GMT GMT
 */

if(!defined('NV_IS_FILE_MODULES'))die('Stop!!!');$sql_drop_module=array();$result=$db->sql_query("SHOW TABLE STATUS LIKE '".$db_config['prefix']."\_".$lang."\_".$module_data."\_%'");$num_table=intval($db->sql_numrows($result));if($num_table>0){$result=$db->sql_query("SELECT `catid` FROM `".$db_config['prefix']."_".$lang."_".$module_data."_cat` ORDER BY `order` ASC");while(list($catid_i)=$db->sql_fetchrow($result)){$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_".$catid_i."`";}$db->sql_freeresult();list($maxid)=$db->sql_fetchrow($db->sql_query("SELECT max(`id`) FROM `".$db_config['prefix']."_".$lang."_".$module_data."_rows`"));$i1=1;while($i1<=$maxid){$tb=ceil($i1/2000);$db->sql_query("DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_bodyhtml_".$tb."`");$i1=$i1+2000;}}$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_cat`";$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_sources`";$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_topics`";$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_comments`";$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_block_cat`";$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_block`";$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_rows`";$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_bodytext`";$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_config_post`";$sql_drop_module[]="DROP TABLE IF EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_admins`";$sql_create_module=$sql_drop_module;$sql_create_module[]="CREATE TABLE `".$db_config['prefix']."_".$lang."_".$module_data."_cat` (\n\t  `catid` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,\n\t  `parentid` mediumint(8) unsigned NOT NULL DEFAULT '0',\n\t  `title` varchar(255) NOT NULL,\n\t  `titlesite` varchar(255) NOT NULL,\n\t  `alias` varchar(255) NOT NULL DEFAULT '',\n\t  `description` varchar(255) NOT NULL,\n\t  `image` varchar(255) NOT NULL DEFAULT '',\n\t  `thumbnail` varchar(255) NOT NULL DEFAULT '',\n\t  `weight` smallint(4) unsigned NOT NULL DEFAULT '0',\n\t  `order` mediumint(8) NOT NULL DEFAULT '0',\n\t  `lev` smallint(4) NOT NULL DEFAULT '0',\n\t  `viewcat` varchar(50) NOT NULL DEFAULT 'viewcat_page_new',\n\t  `numsubcat` int(11) NOT NULL DEFAULT '0',\n\t  `subcatid` varchar(255) NOT NULL DEFAULT '',\n\t  `inhome` tinyint(1) unsigned NOT NULL DEFAULT '0',\n\t  `numlinks` tinyint(2) unsigned NOT NULL DEFAULT '3',\n\t  `keywords` mediumtext NOT NULL,\n\t  `admins` mediumtext NOT NULL,\n\t  `add_time` int(11) unsigned NOT NULL DEFAULT '0',\n\t  `edit_time` int(11) unsigned NOT NULL DEFAULT '0',\n\t  `who_view` tinyint(2) unsigned NOT NULL DEFAULT '0',\n\t  `groups_view` varchar(255) NOT NULL DEFAULT '',\n\t  PRIMARY KEY (`catid`),\n\t  UNIQUE KEY `alias` (`alias`),\n\t  KEY `parentid` (`parentid`)\n\t) ENGINE=MyISAM";$sql_create_module[]="CREATE TABLE `".$db_config['prefix']."_".$lang."_".$module_data."_sources` (\n\t  `sourceid` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,\n\t  `title` varchar(255) NOT NULL DEFAULT '',\n\t  `link` varchar(255) NOT NULL DEFAULT '',\n\t  `logo` varchar(255) NOT NULL DEFAULT '',\n\t  `weight` mediumint(8) unsigned NOT NULL DEFAULT '0',\n\t  `add_time` int(11) unsigned NOT NULL,\n\t  `edit_time` int(11) unsigned NOT NULL,\n\t  PRIMARY KEY (`sourceid`),\n\t  UNIQUE KEY `title` (`title`)\n\t) ENGINE=MyISAM";$sql_create_module[]="CREATE TABLE `".$db_config['prefix']."_".$lang."_".$module_data."_topics` (\n\t  `topicid` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,\n\t  `title` varchar(255) NOT NULL DEFAULT '',\n\t  `alias` varchar(255) NOT NULL DEFAULT '',\n\t  `image` varchar(255) NOT NULL,\n\t  `thumbnail` varchar(255) NOT NULL,\n\t  `description` varchar(255) NOT NULL,\n\t  `weight` smallint(4) NOT NULL DEFAULT '0',\n\t  `keywords` mediumtext NOT NULL,\n\t  `add_time` int(11) NOT NULL DEFAULT '0',\n\t  `edit_time` int(11) NOT NULL DEFAULT '0',\n\t  PRIMARY KEY (`topicid`),\n\t  UNIQUE KEY `title` (`title`),\n\t  UNIQUE KEY `alias` (`alias`)\n\t) ENGINE=MyISAM";$sql_create_module[]="CREATE TABLE `".$db_config['prefix']."_".$lang."_".$module_data."_block_cat` (\n\t  `bid` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,\n\t  `adddefault` tinyint(4) NOT NULL DEFAULT '0',\n\t  `number` mediumint(4) NOT NULL DEFAULT '10',\n\t  `title` varchar(255) NOT NULL DEFAULT '',\n\t  `alias` varchar(255) NOT NULL DEFAULT '',\n\t  `image` varchar(255) NOT NULL,\n\t  `thumbnail` varchar(255) NOT NULL,\n\t  `description` varchar(255) NOT NULL,\n\t  `weight` smallint(4) NOT NULL DEFAULT '0',\n\t  `keywords` mediumtext NOT NULL,\n\t  `add_time` int(11) NOT NULL DEFAULT '0',\n\t  `edit_time` int(11) NOT NULL DEFAULT '0',\n\t  PRIMARY KEY (`bid`),\n\t  UNIQUE KEY `title` (`title`),\n\t  UNIQUE KEY `alias` (`alias`)\n\t) ENGINE=MyISAM";$sql_create_module[]="CREATE TABLE `".$db_config['prefix']."_".$lang."_".$module_data."_comments` (\n\t  `cid` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,\n\t  `id` mediumint(8) unsigned NOT NULL DEFAULT '0',\n\t  `content` mediumtext NOT NULL,\n\t  `post_time` int(11) unsigned NOT NULL DEFAULT '0',\n\t  `userid` int(11) NOT NULL DEFAULT '0',  \n\t  `post_name` varchar(100) NOT NULL,\n\t  `post_email` varchar(100) NOT NULL,\n\t  `post_ip` varchar(15) NOT NULL,\n\t  `status` tinyint(1) unsigned NOT NULL DEFAULT '0',\n\t  PRIMARY KEY (`cid`),\n\t  KEY `post_time` (`post_time`),\n\t  KEY `id` (`id`)\n\t) ENGINE=MyISAM";$sql_create_module[]="CREATE TABLE `".$db_config['prefix']."_".$lang."_".$module_data."_block` (\n\t  `bid` int(11) unsigned NOT NULL,\n\t  `id` int(11) unsigned NOT NULL,\n\t  `weight` int(11) unsigned NOT NULL,\n\t  UNIQUE KEY `bid` (`bid`,`id`)\n\t) ENGINE=MyISAM";$sql_create_module[]="CREATE TABLE `".$db_config['prefix']."_".$lang."_".$module_data."_rows` (\n\t  `id` int(11) unsigned NOT NULL auto_increment,\n\t  `catid` mediumint(8) unsigned NOT NULL default '0',\n\t  `listcatid` varchar(255) NOT NULL default '',\n\t  `topicid` mediumint(8) unsigned NOT NULL default '0',\n\t  `admin_id` mediumint(8) unsigned NOT NULL default '0',\n\t  `author` varchar(255) NOT NULL default '',\n\t  `sourceid` mediumint(8) NOT NULL default '0',\n\t  `addtime` int(11) unsigned NOT NULL default '0',\n\t  `edittime` int(11) unsigned NOT NULL default '0',\n\t  `status` tinyint(4) NOT NULL default '1',\n\t  `publtime` int(11) unsigned NOT NULL default '0',\n\t  `exptime` int(11) unsigned NOT NULL default '0',\n\t  `archive` tinyint(1) unsigned NOT NULL default '0',\n\t  `title` varchar(255) NOT NULL default '',\n\t  `alias` varchar(255) NOT NULL default '',\n\t  `hometext` mediumtext NOT NULL,\n\t  `homeimgfile` varchar(255) NOT NULL default '',\n\t  `homeimgalt` varchar(255) NOT NULL default '',\n\t  `homeimgthumb` varchar(255) NOT NULL default '',\n\t  `inhome` tinyint(1) unsigned NOT NULL default '0',\n\t  `allowed_comm` tinyint(1) unsigned NOT NULL default '0',\n\t  `allowed_rating` tinyint(1) unsigned NOT NULL default '0',\n\t  `hitstotal` mediumint(8) unsigned NOT NULL default '0',\n\t  `hitscm` mediumint(8) unsigned NOT NULL default '0',\n\t  `total_rating` int(11) NOT NULL default '0',\n\t  `click_rating` int(11) NOT NULL default '0',\n\t  `keywords` text NOT NULL,\n\t  PRIMARY KEY (`id`),\n\t  KEY `catid` (`catid`),\n\t  KEY `topicid` (`topicid`),\n\t  KEY `admin_id` (`admin_id`),\n\t  KEY `author` (`author`),\n\t  KEY `title` (`title`),\n\t  KEY `addtime` (`addtime`),\n\t  KEY `publtime` (`publtime`),\n\t  KEY `exptime` (`exptime`),\n\t  KEY `status` (`status`)\n\t) ENGINE=MyISAM";$sql_create_module[]="CREATE TABLE IF NOT EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_bodytext` (\n\t  `id` int(11) unsigned NOT NULL,\n\t  `bodytext` mediumtext NOT NULL,\n\t  PRIMARY KEY  (`id`)\n\t) ENGINE=MyISAM";$sql_create_module[]="CREATE TABLE IF NOT EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_bodyhtml_1` (\n\t  `id` int(11) unsigned NOT NULL,\n\t  `bodyhtml` longtext NOT NULL,\n\t  `sourcetext` varchar(255) NOT NULL default '',\n\t  `imgposition` tinyint(1) NOT NULL default '1',\n\t  `copyright` tinyint(1) NOT NULL default '0',\n\t  `allowed_send` tinyint(1) NOT NULL default '0',\n\t  `allowed_print` tinyint(1) NOT NULL default '0',\n\t  `allowed_save` tinyint(1) NOT NULL default '0',\t  \n\t  PRIMARY KEY  (`id`)\n\t) ENGINE=MyISAM";$sql_create_module[]="CREATE TABLE IF NOT EXISTS `".$db_config['prefix']."_".$lang."_".$module_data."_config_post` (\n\t  `pid` mediumint(9) NOT NULL AUTO_INCREMENT,\n\t  `member` tinyint(4) NOT NULL,\n\t  `group_id` mediumint(9) NOT NULL,\n\t  `addcontent` tinyint(4) NOT NULL,\n\t  `postcontent` tinyint(4) NOT NULL,\n\t  `editcontent` tinyint(4) NOT NULL,\n\t  `delcontent` tinyint(4) NOT NULL,\n\t  PRIMARY KEY  (`pid`),\n\t  UNIQUE KEY `member` (`member`,`group_id`)\n\t) ENGINE=MyISAM";$sql_create_module[]="CREATE TABLE `".$db_config['prefix']."_".$lang."_".$module_data."_admins` (\n\t  `userid` int(11) NOT NULL default '0',\n\t  `catid` int(11) NOT NULL default '0',\n\t  `admin` tinyint(4) NOT NULL default '0',\n\t  `add_content` tinyint(4) NOT NULL default '0',\n\t  `pub_content` tinyint(4) NOT NULL default '0',\n\t  `edit_content` tinyint(4) NOT NULL default '0',\n\t  `del_content` tinyint(4) NOT NULL default '0',\n\t  `comment` tinyint(4) NOT NULL default '0',\n\t  UNIQUE KEY `userid` (`userid`,`catid`)\n\t) ENGINE=MyISAM";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'indexfile', 'viewcat_main_right')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'per_page', '20')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'st_links', '10')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'auto_postcomm', '1')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'homewidth', '100')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'homeheight', '150')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'blockwidth', '52')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'blockheight', '75')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'imagefull', '460')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'setcomm', '2')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'copyright', '')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'showhometext', '1')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'activecomm', '1')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'emailcomm', '1')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'timecheckstatus', '0')";$sql_create_module[]="INSERT INTO `".NV_CONFIG_GLOBALTABLE."` (`lang`, `module`, `config_name`, `config_value`) VALUES ('".$lang."', '".$module_name."', 'config_source', '0')";

?>